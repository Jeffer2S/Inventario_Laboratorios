<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Lista de Laboratoristas</title>
  <link rel="stylesheet" href="https://cdn.datatables.net/1.11.5/css/jquery.dataTables.min.css">
  <link rel="stylesheet" href="estilos_Admin_acciones.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
</head>
<body>
<style>
  table.dataTable {
    border-collapse: collapse;
    width: 100%;
    box-shadow: 0 0 10px rgb(119, 116, 116);
    margin: 10px auto;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    font-size: 15px;
    border-radius: 5px;
    background-color: rgb(168, 166, 166);
  }

  table.dataTable th {
    text-transform: uppercase;
    letter-spacing: 1px;
    background-color: rgb(168, 166, 166);
  }
</style>

<h1 class="text-center">Lista de Laboratoristas</h1>

<div class="container">
  <table id="tablaLaboratoristas" class="table">
    <thead>
      <tr>
        <th>Nro Cedula</th>
        <th>Nombre</th>
        <th>Apellido</th>
        <th>Direccion</th>
        <th>Telefono</th>
        <th>Sexo</th>
        <th style="display: none;"></th> 
        <th style="display: none;"></th> 
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<form id="myForm" action="./actualizarLab.php" method="POST" style="display: none;">
  <fieldset>
    <legend> Datos del Laboratorista</legend>
    <div class="mb-3">
      <label for="ced_lab" class="form-label">Nro Cedula: </label>
      <input type="text" id="ced_lab" name="ced_lab" class="form-control" placeholder="Ingrese cedula" readonly>
    </div>
    <div class="mb-3">
      <label for="nom_lab" class="form-label">Nombre: </label>
      <input type="text" id="nom_lab" name="nom_lab" class="form-control" placeholder="Ingrese nombre">
    </div>
    <div class="mb-3">
      <label for="ape_lab" class="form-label">Apellido: </label>
      <input type="text" id="ape_lab" name="ape_lab" class="form-control" placeholder="Ingrese apellido">
    </div>
    <div class="mb-3">
      <label for="dir_lab" class="form-label">Direccion: </label>
      <input type="text" id="dir_lab" name="dir_lab" class="form-control" placeholder="Ingrese direccion">
    </div>
    <div class="mb-3">
      <label for="tel_lab" class="form-label">Telefono: </label>
      <input type="text" id="tel_lab" name="tel_lab" class="form-control" placeholder="Ingrese telefono">
    </div>
    <div class="mb-3">
      <label for="sex_lab" class="form-label">Seleccione Sexo</label>
      <select id="sex_lab" name="sex_lab" class="form-select">
        <option value="Masculino">Masculino</option>
        <option value="Femenino">Femenino</option>
        <option value="Otros">Otros</option>
      </select>
    </div>
    <button type="submit" class="btn btn-primary">Actualizar Datos</button>
  </fieldset>
</form>

<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdn.datatables.net/1.11.5/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"></script>

<script>
  $(document).ready(function() {
    $('#tablaLaboratoristas').DataTable({
      "ajax": {
        "url": "editarLab.php",
        "dataSrc": ""
      },
      "pageLength": 10,
      "columns": [
        { "data": "ced_lab" },
        { "data": "nom_lab" },
        { "data": "ape_lab" },
        { "data": "dir_lab" },
        { "data": "tel_lab" },
        { "data": "sex_lab" },
        {
          "render": function(data, type, full, meta) {
            return '<button onclick="editarRegistro(' + full.ced_lab + ')" class="btn btn-primary">Editar</button>';
          }
        },
        {
          "render": function(data, type, full, meta) {
            return '<button onclick="eliminarRegistro(' + full.ced_lab + ')" class="btn btn-danger">Eliminar</button>';
          }
        }
      ]
    });
  });

  function editarRegistro(cedula) {
    $('#tablaLaboratoristas').hide(); 
    $('#myForm').show(); 
    $('#ced_lab').val(cedula).prop('readonly', true);
  }

  function eliminarRegistro(cedula) {
    $.ajax({
      url: 'eliminarLab.php',
      method: 'POST',
      data: { ced_lab: cedula },
      success: function(response) {
        location.reload();
      },
      error: function(xhr, status, error) {
        console.error(error);
      }
    });
  }
</script>
</body>
</html>
